<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gemini File Search Uploader</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1>Gemini File Search</h1>
    </div>

    <!-- API Key Section -->
    <div class="section">
      <label for="apiKeyInput">APIキー</label>
      <div class="input-group">
        <input type="password" id="apiKeyInput" placeholder="Gemini APIキーを入力">
        <button id="toggleApiKeyBtn" class="icon-btn" title="表示/非表示">👁️</button>
        <button id="saveApiKeyBtn" class="btn-primary">保存</button>
      </div>
      <div id="apiKeyStatus" class="status-message"></div>
    </div>

    <!-- Store Section -->
    <div class="section">
      <label for="storeSelect">ストア選択</label>
      <div class="input-group">
        <select id="storeSelect">
          <option value="">読み込み中...</option>
        </select>
        <button id="refreshStoresBtn" class="icon-btn" title="更新">🔄</button>
        <button id="createStoreBtn" class="btn-secondary">新規作成</button>
      </div>
    </div>

    <!-- 自動抽出セクション -->
    <div id="autoExtractSection" class="section">
      <h3>📄 ページ情報</h3>
      <div class="page-info">
        <div class="info-row">
          <strong>タイトル:</strong>
          <span id="pageTitle">-</span>
        </div>
        <div class="info-row">
          <strong>URL:</strong>
          <a id="pageUrl" href="#" target="_blank">-</a>
        </div>
        <div class="info-row">
          <strong>文字数:</strong>
          <span id="wordCount">-</span>
        </div>
      </div>
      <div class="content-preview">
        <strong>コンテンツプレビュー:</strong>
        <div id="contentPreview" class="preview-text">読み込み中...</div>
      </div>
      <button id="uploadBtn" class="btn-upload" disabled>
        📤 アップロード
      </button>
    </div>

    <!-- 手動入力セクション -->
    <div id="manualInputSection" class="section" style="display: none;">
      <h3>✍️ 手動入力</h3>
      <div class="manual-input-form">
        <div class="form-group">
          <label for="manualTitle">タイトル（任意）:</label>
          <input type="text" id="manualTitle" placeholder="ページタイトル">
        </div>
        <div class="form-group">
          <label for="manualUrl">URL（任意）:</label>
          <input type="text" id="manualUrl" placeholder="https://example.com">
        </div>
        <div class="form-group">
          <label for="manualContent">コンテンツ:</label>
          <textarea id="manualContent" rows="10" placeholder="アップロードするテキストをここに貼り付けてください"></textarea>
          <div class="word-count-display">文字数: <span id="manualWordCount">0 文字</span></div>
        </div>
      </div>
      <button id="manualUploadBtn" class="btn-upload" disabled>📤 手動アップロード</button>
    </div>

    <!-- アップロードステータス -->
    <div class="section">
      <div id="uploadStatus" class="status-message"></div>
      <div id="uploadProgress" class="progress-bar" style="display: none;">
        <div class="progress-fill"></div>
      </div>
    </div>

    <!-- History Section -->
    <div class="section">
      <h3>アップロード履歴</h3>
      <div id="historyList" class="history-list">
        履歴なし
      </div>
    </div>
  </div>

  <!-- Create Store Modal -->
  <div id="createStoreModal" class="modal">
    <div class="modal-content">
      <h3>新規ストア作成</h3>
      <input type="text" id="newStoreName" placeholder="ストア名を入力">
      <div class="modal-actions">
        <button id="confirmCreateBtn" class="btn-primary">作成</button>
        <button id="cancelCreateBtn" class="btn-secondary">キャンセル</button>
      </div>
      <div id="createStoreStatus" class="status-message"></div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>